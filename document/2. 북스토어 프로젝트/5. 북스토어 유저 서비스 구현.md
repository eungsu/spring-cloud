# 북스토어 유저 서비스 구현

## 공통 클래스

- 모델매퍼유틸 클래스
  - 소스 객체의 프로퍼티를 대상 객체로 복사한다.
  - 의존성 추가

```xml
<dependency>
  <groupId>org.modelmapper</groupId>
  <artifactId>modelmapper</artifactId>
  <version>3.0.0</version>
</dependency>
```

```java
import org.modelmapper.ModelMapper;
import org.modelmapper.convention.MatchingStrategies;

public class ModelMapperUtil {

  private static ModelMapper modelMapper;
  static {
    modelMapper = new ModelMapper();
    modelMapper.getConfiguration().setMatchingStrategy(MatchingStrategies.STRICT);
  }

  public static <T> T map(Object source, Class<? extends T> destination) {
    return modelMapper.map(source, destination);
  }
}
```

- JSON 응답 컨텐츠 클래스
  - 성공여부, 에러메세지, 객체 혹은 List를 포함하는 객체다.
  - 컨트롤러의 요청핸들러 메소드는 이 객체를 ResponseEntity에 포함시켜서 반환한다.

```java
import java.util.List;
import com.fasterxml.jackson.annotation.JsonInclude;
import lombok.Getter;

@Getter
@JsonInclude(JsonInclude.Include.NON_NULL)
public class ResponseData {
  private boolean success;
  private String message;
  private Object item;
  private List<?> items;

  public ResponseData( ) {
    this.success = true;
    this.message = null;
  }

  public ResponseData(Object item) {
    this.success = true;
    this.message = null;
    this.item = item;
  }

  public ResponseData(List<?> items) {
    this.success = true;
    this.message = null;
    this.items= items;
  }

  public ResponseData(boolean success, String message) {
    this.success = success;
    this.message = message;
  }
}
```

## 회원가입

### 컨트롤러 클래스 구현

```java
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import com.example.dto.UserDto;
import com.example.service.UserService;
import com.example.util.ModelMapperUtil;
import com.example.vo.web.request.ResponseData;
import com.example.vo.web.request.UserRequest;

import lombok.RequiredArgsConstructor;

@RestController
@RequestMapping("/user-service/users")
@RequiredArgsConstructor
public class UserController {

  private final UserService userService;

  @PostMapping
    public ResponseEntity<ResponseData> createUser(@RequestBody UserRequest userRequest) {
    UserDto userDto = ModelMapperUtil.map(userRequest, UserDto.class);
    userDto = userService.createUser(userDto);

    return ResponseEntity.ok(new ResponseData(userDto));
  }

}
```

### 서비스 클래스 구현

```java
import com.example.dto.UserDto;

public interface UserService {
  UserDto createUser(UserDto userDto);
}
```

```java
import org.springframework.stereotype.Service;

import com.example.dto.UserDto;
import com.example.mapper.UserMapper;
import com.example.util.ModelMapperUtil;
import com.example.vo.User;

import lombok.RequiredArgsConstructor;

@Service
@RequiredArgsConstructor
public class UserServicImpl implements UserService {

  private final UserMapper userMapper;

  public UserDto createUser(UserDto userDto) {
    User user = ModelMapperUtil.map(userDto, User.class);
    userMapper.insertUser(user);

    return userDto;
  }
}
```

### 매퍼 인터페이스 구현

### Request와 DTO 클래스 구현

